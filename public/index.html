<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Article Manager</title>
</head>
<body>

<h1>Save Highlights</h1>
<form id="highlight-form">
  <textarea id="highlight-text" placeholder="Enter highlight text" required></textarea>
  <button type="submit">Save Highlight</button>
</form>

<div id="highlight-list"></div>

<h2>Tweet-Sized Nuggets</h2>
<button onclick="fetchNuggets()">Get Nuggets</button>
<div id="nuggets-list"></div>

<script>
  document.getElementById('highlight-form').addEventListener('submit', async (event) => {
    event.preventDefault();

    const text = document.getElementById('highlight-text').value;
    
    try {
      const response = await fetch('/highlights/save', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ text }),
      });

      const data = await response.json();
      alert(data.message);
      document.getElementById('highlight-text').value = ''; // Clear the input field
      fetchHighlights(); // Refresh the list of highlights
    } catch (error) {
      console.error('Error saving highlight:', error);
    }
  });

  async function fetchHighlights() {
    try {
      const response = await fetch('/highlights/nuggets');
      const data = await response.json();

      const highlightList = document.getElementById('highlight-list');
      highlightList.innerHTML = '';

      data.highlights.forEach(highlight => {
        const div = document.createElement('div');
        div.textContent = highlight;
        highlightList.appendChild(div);
      });
    } catch (error) {
      console.error('Error fetching highlights:', error);
    }
  }

  async function fetchNuggets() {
    try {
      const response = await fetch('/highlights/nuggets');
      const data = await response.json();

      const nuggetsList = document.getElementById('nuggets-list');
      nuggetsList.innerHTML = '';

      data.nuggets.forEach(nugget => {
        const div = document.createElement('div');
        div.textContent = nugget;
        nuggetsList.appendChild(div);
      });
    } catch (error) {
      console.error('Error fetching nuggets:', error);
    }
  }

  fetchHighlights(); // Load highlights on page load
</script>

</body>
</html>
